<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bee Swarm Fan Game</title>
<style>
  body { margin: 0; overflow: hidden; }
  #ui {
    position: fixed;
    top: 10px;
    left: 10px;
    color: white;
    font-family: Arial;
    font-size: 18px;
    background: rgba(0,0,0,0.4);
    padding: 10px;
    border-radius: 8px;
  }
</style>
</head>
<body>

<div id="ui">
  <div>üêù Pollen: <span id="pollen">0</span></div>
  <div>üè† Hive Pollen: <span id="hivePollen">0</span></div>
  <div>üü° Bees in Hive: <span id="hiveCount">0</span></div>
  <div>üß∏ Quest: <span id="questText">None</span></div>
  <div>WASD = Move</div>
  <div>H = Hive | E = Bear</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.158/build/three.min.js"></script>
<script>
// ===== SCENE =====
const scene = new THREE.Scene();

// SKY (100% SAFE, NO EXTERNAL FILES)
scene.background = new THREE.Color(0x87ceeb);
scene.fog = new THREE.Fog(0x87ceeb, 10, 200);

// ===== CAMERA =====
const camera = new THREE.PerspectiveCamera(75, innerWidth / innerHeight, 0.1, 1000);
camera.position.set(0, 6, 8);

// ===== RENDERER =====
const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

// ===== LIGHT =====
const sun = new THREE.DirectionalLight(0xffffff, 1);
sun.position.set(10, 20, 10);
scene.add(sun);
scene.add(new THREE.AmbientLight(0xffffff, 0.4));

// ===== GROUND =====
const ground = new THREE.Mesh(
  new THREE.PlaneGeometry(200, 200),
  new THREE.MeshStandardMaterial({ color: 0x3cb043 })
);
ground.rotation.x = -Math.PI / 2;
scene.add(ground);

// ===== PLAYER =====
const player = new THREE.Mesh(
  new THREE.BoxGeometry(1,1,1),
  new THREE.MeshStandardMaterial({ color: 0xffd700 })
);
player.position.y = 0.5;
scene.add(player);

// ===== HIVE =====
const hive = new THREE.Mesh(
  new THREE.CylinderGeometry(1,1,2,6),
  new THREE.MeshStandardMaterial({ color: 0xfff2a6 })
);
hive.position.set(0,1,-10);
scene.add(hive);

// ===== BEES =====
const bees = [];
for(let i=0;i<3;i++){
  const mesh = new THREE.Mesh(
    new THREE.SphereGeometry(0.3),
    new THREE.MeshStandardMaterial({ color: 0xffcc00 })
  );
  scene.add(mesh);
  bees.push({ mesh, inHive:false });
}

// ===== FLOWERS =====
const flowers = [];
for(let i=0;i<25;i++){
  const flower = new THREE.Mesh(
    new THREE.ConeGeometry(0.3,1),
    new THREE.MeshStandardMaterial({ color: 0xff69b4 })
  );
  flower.position.set(Math.random()*80-40,0.5,Math.random()*80-40);
  scene.add(flower);
  flowers.push(flower);
}

// ===== BEAR =====
const bear = new THREE.Mesh(
  new THREE.BoxGeometry(1,1.5,1),
  new THREE.MeshStandardMaterial({ color: 0x8b4513 })
);
bear.position.set(10,0.75,0);
scene.add(bear);

let questGoal = 10;
let questProgress = 0;

// ===== INPUT =====
const keys = {};
onkeydown = e => keys[e.key.toLowerCase()] = true;
onkeyup = e => keys[e.key.toLowerCase()] = false;

// ===== STATS =====
let pollen = 0;
let hivePollen = 0;

// ===== LOOP =====
function animate(){
  requestAnimationFrame(animate);

  // Movement
  if(keys.w) player.position.z -= 0.25;
  if(keys.s) player.position.z += 0.25;
  if(keys.a) player.position.x -= 0.25;
  if(keys.d) player.position.x += 0.25;

  camera.position.x = player.position.x;
  camera.position.z = player.position.z + 8;
  camera.lookAt(player.position);

  // Bees follow
  bees.forEach((b,i)=>{
    if(!b.inHive){
      b.mesh.position.x += (player.position.x - b.mesh.position.x) * 0.05;
      b.mesh.position.z += (player.position.z - b.mesh.position.z) * 0.05;
      b.mesh.position.y = 1 + Math.sin(Date.now()*0.005+i)*0.2;
    }
  });

  // Collect pollen
  flowers.forEach((f,i)=>{
    if(f.position.distanceTo(player.position)<1){
      scene.remove(f);
      flowers.splice(i,1);
      pollen++;
      pollenEl.innerText = pollen;
    }
  });

  // Hive
  if(keys.h && player.position.distanceTo(hive.position)<2){
    const bee = bees.find(b=>!b.inHive);
    if(bee){
      bee.inHive = true;
      bee.mesh.visible = false;
      hiveCountEl.innerText = bees.filter(b=>b.inHive).length;
    }
  }

  // Hive pollen
  const count = bees.filter(b=>b.inHive).length;
  hivePollen += count * 0.02;
  hivePollenEl.innerText = Math.floor(hivePollen);

  // Bear quest
  if(player.position.distanceTo(bear.position)<2){
    questTextEl.innerText = `Give ${questGoal - questProgress} pollen`;
    if(keys.e && pollen>0){
      pollen--;
      questProgress++;
      pollenEl.innerText = pollen;
      if(questProgress>=questGoal){
        alert("Quest complete! New bee!");
        const bee = bees.find(b=>b.inHive===false);
        if(bee){
          bee.inHive=true;
          bee.mesh.visible=false;
          hiveCountEl.innerText = bees.filter(b=>b.inHive).length;
        }
        questProgress=0;
        questGoal = 10 + Math.floor(Math.random()*10);
      }
    }
  } else {
    questTextEl.innerText = "None";
  }

  renderer.render(scene,camera);
}

// ===== UI =====
const pollenEl = document.getElementById("pollen");
const hivePollenEl = document.getElementById("hivePollen");
const hiveCountEl = document.getElementById("hiveCount");
const questTextEl = document.getElementById("questText");

animate();
</script>
</body>
</html>

